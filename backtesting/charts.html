<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="Access-Control-Allow-Origin" content="*" />
    <title>ECharts</title>
    <script src="https://cdn.staticfile.org/echarts/5.0.2/echarts.min.js"></script>
    <script src="https://cdn.staticfile.org/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/vue/2.2.2/vue.min.js"></script>
</head>
<body>
    <div id="main" style="width:800px; height:500px;"></div>
    <script type="text/javascript">

        function arrToNumber(arr) {
            a = arr.map(Number).filter(Boolean);
            a[0] = Math.round(a[0] / 1000);
            return a;
        }

        var myChart = echarts.init(document.getElementById('main'));
        myChart.showLoading();

        $.get('http://172.17.34.10:5926/backtesting', function(datas) {
            myChart.hideLoading();
            datas = JSON.parse(datas);

            source = [];
            datas.map(function(item, index, _) {
                source.push(arrToNumber(item));
            });
            const dimensions = [{name: 'time', type: 'ordinal'}, 'price', 'ask', 'bid'];

            console.log(source);

            myChart.setOption({
                title: {text: 'backtesting'},
                dataset: {
                    dimensions: dimensions,
                    source: source
                },
                xAxis: {
                    type: 'value',
                    name: 'time',
                    scale: true,
                    axisLabel: {rotate: 50, interval: 0}
                },
                yAxis: {
                    type: 'value',
                    name: 'price'
                },
                series: [{
                    type: 'scatter',
                    symbolSize: 1,
                    encode: {
                        x: 'time',
                        y: 'price'
                    }
                }]

            });
        })
    </script>
</body>
</html>
